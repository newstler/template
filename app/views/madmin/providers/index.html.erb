<div class="max-w-3xl mx-auto">
  <div class="mb-8">
    <h1 class="text-3xl font-bold text-dark-50"><%= t(".heading") %></h1>
    <p class="mt-2 text-sm text-dark-400"><%= t(".description") %></p>
  </div>

  <%= form_with url: main_app.madmin_providers_path, method: :patch, class: "space-y-6" do |form| %>
    <% @providers.each do |provider, settings| %>
      <div class="bg-dark-900 py-8 px-6 rounded-xl border border-dark-700">
        <div class="flex items-center gap-3 mb-6">
          <h2 class="text-xl font-semibold text-dark-100"><%= t(".providers.#{provider}", default: provider.titleize) %></h2>
          <% if ProviderCredential.configured?(provider) %>
            <span class="w-2 h-2 bg-green-400 rounded-full"></span>
          <% end %>
        </div>
        <div class="space-y-4">
          <% settings.each do |setting| %>
            <% credential = @credentials[[provider, setting]] %>
            <% field_name = "providers[#{provider}][#{setting}]" %>
            <% field_id = "providers_#{provider}_#{setting}" %>
            <% is_secret = setting.end_with?("_key", "_secret", "_token") %>
            <div>
              <%= label_tag field_id, t(".settings.#{setting}", default: setting.titleize), class: "block text-sm font-medium text-dark-200 mb-2" %>
              <% if is_secret %>
                <%= password_field_tag field_name, credential&.value,
                  id: field_id,
                  placeholder: t(".key_placeholder"),
                  class: "w-full px-4 py-3 border border-dark-600 bg-dark-800 text-dark-100 rounded-lg focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 focus:outline-none transition-all placeholder-dark-500 font-mono text-sm" %>
              <% else %>
                <%= text_field_tag field_name, credential&.value,
                  id: field_id,
                  placeholder: t(".placeholders.#{setting}", default: ""),
                  class: "w-full px-4 py-3 border border-dark-600 bg-dark-800 text-dark-100 rounded-lg focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 focus:outline-none transition-all placeholder-dark-500 text-sm" %>
              <% end %>
            </div>
          <% end %>
        </div>
      </div>
    <% end %>

    <%# Actions %>
    <div class="flex items-center gap-4">
      <%= submit_tag t(".save"),
        class: "bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 text-white py-3 px-6 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500/50 font-medium transition-all cursor-pointer shadow-lg shadow-blue-500/25" %>
    </div>
  <% end %>
</div>
