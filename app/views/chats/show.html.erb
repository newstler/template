<%= turbo_stream_from "chat_#{@chat.id}" %>

<% content_for :title, t(".title", default: "Chat") %>
<% content_for :full_width, true %>

<div class="relative h-[calc(100vh-64px)] lg:h-screen">
  <%# Messages container - full height with scroll %>
  <div class="absolute inset-0 overflow-y-auto" data-controller="scroll-bottom">
    <%# Top gradient fade %>
    <div class="sticky top-0 h-12 bg-gradient-to-b from-dark-800 to-transparent pointer-events-none z-10"></div>

    <div id="messages" class="max-w-4xl mx-auto px-4 pb-72">
      <%= render partial: "messages/message", collection: @chat.messages.reject { |m| m.id.nil? }, as: :message %>
    </div>
  </div>

  <%# Input area - floating at bottom %>
  <div class="absolute bottom-0 left-0 right-0 z-20 pointer-events-none">
    <%# Bottom gradient fade %>
    <div class="h-24 bg-gradient-to-t from-dark-800 to-transparent"></div>

    <%# Input container %>
    <div class="bg-dark-800 pb-6 pointer-events-auto">
      <div class="max-w-4xl mx-auto px-4">
        <%= render "messages/form", chat: @chat, message: @message %>
      </div>
    </div>
  </div>
</div>
