<%# Modern dark sidebar navigation - inspired by Anthropic/OpenAI/Lovable %>

<%# Sidebar %>
<aside data-sidebar-target="sidebar"
       class="fixed inset-y-0 left-0 z-40 w-64 bg-[#1a1d24] transform -translate-x-full lg:translate-x-0 transition-transform duration-200 ease-in-out flex flex-col">

  <%# Logo/Brand %>
  <div class="flex items-center h-16 px-4">
    <%= link_to root_path, class: "flex items-center gap-3 text-white hover:opacity-80 transition-opacity" do %>
      <div class="w-8 h-8 bg-gradient-to-br from-accent-500 to-accent-700 rounded-lg flex items-center justify-center">
        <%= inline_svg "icons/lightning.svg", class: "w-5 h-5 text-white" %>
      </div>
      <span class="font-semibold text-lg"><%= content_for(:app_name) || "Template" %></span>
    <% end %>
  </div>

  <%# Navigation %>
  <nav class="flex-1 overflow-y-auto py-4 px-3">
    <%# Main Navigation %>
    <div class="space-y-1">
      <%= render "shared/sidebar_link", path: root_path, icon: "home", label: "Home" %>
    </div>

    <%# Chats Section (collapsible) %>
    <div class="mt-6">
      <%= render "shared/sidebar_group", id: "chats", icon: "chat", label: "Chats" do %>
        <%= render "shared/sidebar_link", path: new_chat_path, icon: "plus", label: "New Chat", nested: true %>
        <% current_user&.chats&.order(updated_at: :desc)&.limit(10)&.each do |chat| %>
          <% first_user_message = chat.messages.find_by(role: "user")&.content || "Untitled" %>
          <%= render "shared/sidebar_link", path: chat_path(chat), icon: "chat", label: first_user_message, nested: true, truncate: true %>
        <% end %>
      <% end %>
    </div>
  </nav>

  <%# User section %>
  <div class="p-4">
    <div class="flex items-center gap-3 mb-3">
      <div class="w-8 h-8 bg-gradient-to-br from-blue-600 to-purple-600 rounded-full flex items-center justify-center">
        <span class="text-sm font-medium text-white"><%= current_user&.name&.first&.upcase || "U" %></span>
      </div>
      <div class="flex-1 min-w-0">
        <p class="text-sm font-medium text-dark-100 truncate"><%= current_user&.name || "User" %></p>
        <p class="text-xs text-dark-500 truncate"><%= current_user&.email %></p>
      </div>
    </div>
    <%= button_to session_path, method: :delete, class: "w-full flex items-center gap-2 px-3 py-2 text-sm text-dark-500 hover:text-dark-200 hover:bg-white/5 rounded-lg transition-colors" do %>
      <%= inline_svg "icons/sign-out.svg", class: "w-4 h-4" %>
      Sign Out
    <% end %>
  </div>
</aside>

<%# Mobile overlay %>
<div data-sidebar-target="overlay"
     data-action="click->sidebar#close"
     class="fixed inset-0 z-30 bg-black/50 backdrop-blur-sm hidden lg:hidden"></div>
