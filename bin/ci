#!/usr/bin/env bash
set -e

echo "=== Running CI Pipeline ==="
echo ""

echo "ğŸ“‹ Step 1/5: Checking Ruby syntax..."
ruby -c app/**/*.rb lib/**/*.rb 2>/dev/null || true
echo "âœ… Syntax check complete"
echo ""

echo "ğŸ” Step 2/5: Running RuboCop..."
bundle exec rubocop -A --fail-level=E
echo "âœ… RuboCop complete"
echo ""

echo "ğŸ§ª Step 3/5: Running tests..."
rails test
echo "âœ… Tests complete"
echo ""

echo "ğŸ”’ Step 4/5: Running Brakeman security scan..."
bin/brakeman --no-pager
echo "âœ… Security scan complete"
echo ""

echo "ğŸŒ Step 5/5: Checking i18n translations..."
bundle exec i18n-tasks health
echo "âœ… i18n check complete"
echo ""

echo "=== All CI checks passed! ==="
