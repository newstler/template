#!/usr/bin/env bash
set -e

echo "=== Running CI Pipeline ==="
echo ""

echo "ğŸ“‹ Step 1/4: Checking Ruby syntax..."
ruby -c app/**/*.rb lib/**/*.rb 2>/dev/null || true
echo "âœ… Syntax check complete"
echo ""

echo "ğŸ” Step 2/4: Running RuboCop..."
bundle exec rubocop -A --fail-level=E
echo "âœ… RuboCop complete"
echo ""

echo "ğŸ§ª Step 3/4: Running tests..."
rails test
echo "âœ… Tests complete"
echo ""

echo "ğŸ”’ Step 4/4: Running Brakeman security scan..."
bundle exec brakeman -q --no-pager --no-exit-on-warn
echo "âœ… Security scan complete"
echo ""

echo "=== All CI checks passed! ==="
